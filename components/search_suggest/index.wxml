<!-- 搜索建议组件 - TDesign版本 -->
<view class="search-suggest-container {{customClass}}" style="{{customStyle}}">
  <!-- 搜索输入框 -->
  <view class="search-input-wrapper {{shape === 'round' ? 'round' : 'square'}} {{focused ? 'focused' : ''}}">
    <!-- 搜索图标 -->
    <view class="search-icon">
      <t-icon name="search" size="18" color="#999" />
    </view>
    
    <!-- 输入框 -->
    <input 
      class="search-input"
      type="text"
      value="{{inputValue}}"
      placeholder="{{placeholder}}"
      bindinput="onInputChange"
      bindfocus="onInputFocus"
      bindblur="onInputBlur"
      confirm-type="search"
      bindconfirm="onSearchTap"
    />
    
    <!-- 清空按钮 -->
    <view 
      class="clear-button {{inputValue ? 'show' : 'hide'}} {{activeStates.clearButton ? 'clear-button-active' : ''}}" 
      wx:if="{{showClearButton}}"
      bindtap="onClearInput"
      bindtouchstart="onButtonTouchStart"
      bindtouchend="onButtonTouchEnd"
      data-button="clear"
    >
      <t-icon name="close-circle-filled" size="16" color="#999" />
    </view>
    
    <!-- 搜索按钮 -->
    <view 
      class="search-button {{activeStates.searchButton ? 'search-button-active' : ''}}" 
      wx:if="{{showSearchButton}}"
      bindtap="onSearchTap"
      bindtouchstart="onButtonTouchStart"
      bindtouchend="onButtonTouchEnd"
      data-button="search"
      style="background-color: {{themeColor}}"
    >
      <text class="search-button-text">{{searchButtonText}}</text>
    </view>
  </view>
  
  <!-- 建议下拉框 -->
  <view class="suggestions-dropdown {{showSuggestions ? 'show' : 'hide'}}" wx:if="{{showSuggestions}}">
    <!-- 加载状态 -->
    <view class="loading-wrapper" wx:if="{{isLoading}}">
      <t-loading size="small" theme="circular" loading="{{true}}" />
      <text class="loading-text">搜索中...</text>
    </view>
    
    <!-- 搜索建议列表 -->
    <scroll-view 
      class="suggestions-list" 
      scroll-y="true"
      type="list"
      wx:if="{{!isLoading && suggestions.length > 0}}"
    >
      <view class="suggestion-list-item">
        <view class="suggestions-header">
          <text class="suggestions-title">搜索建议</text>
        </view>
        <t-cell-group 
          class="suggestion-cells"
          bordered="{{false}}"
        >
          <t-cell 
            wx:for="{{suggestions}}"
            wx:key="id"
            class="suggestion-cell {{activeStates.suggestionItems[index] ? 'suggestion-item-active' : ''}}"
            list-item
            bindtap="onSuggestionTap"
            bindtouchstart="onItemTouchStart"
            bindtouchend="onItemTouchEnd"
            data-item="{{item}}"
            data-index="{{index}}"
            data-type="suggestion"
            title="{{item.title || item.text || item}}"
            description="{{item.description}}"
            left-icon="{{item.icon || 'search'}}"
            hover="{{true}}"
            clickable="{{true}}"
          >
            <!-- 自定义右侧内容 -->
            <view slot="right" wx:if="{{item.tag}}" class="suggestion-tag">
              <t-tag variant="light" size="small" theme="default">{{item.tag}}</t-tag>
            </view>
          </t-cell>
        </t-cell-group>
      </view>
    </scroll-view>
    
    <!-- 搜索历史 -->
    <scroll-view
      class="history-list" 
      scroll-y="true"
      type="list"
      wx:if="{{!isLoading && suggestions.length === 0 && searchHistory.length > 0}}"
    >
      <view class="history-list-item">
        <view class="history-header">
          <text class="history-title">搜索历史</text>
          <t-button 
            class="clear-history-btn {{activeStates.clearHistoryBtn ? 'clear-history-btn-active' : ''}}" 
            variant="text"
            size="extra-small"
            bindtap="onClearHistory"
            bindtouchstart="onButtonTouchStart"
            bindtouchend="onButtonTouchEnd"
            data-button="clearHistory"
          >
            <t-icon name="delete" size="14" color="#999" />
            <text class="clear-text">清空</text>
          </t-button>
        </view>
        <t-cell-group 
          class="history-cells"
          bordered="{{false}}"
        >
          <t-cell 
            wx:for="{{searchHistory}}"
            wx:key="index"
            class="history-cell {{activeStates.historyItems[index] ? 'history-item-active' : ''}}"
            list-item
            bindtap="onHistoryTap"
            bindtouchstart="onItemTouchStart"
            bindtouchend="onItemTouchEnd"
            data-item="{{item}}"
            data-index="{{index}}"
            data-type="history"
            title="{{item}}"
            left-icon="history"
            hover="{{true}}"
            clickable="{{true}}"
          >
            <!-- 自定义右侧删除按钮 -->
            <view slot="right">
              <t-button 
                class="delete-history-btn {{activeStates.deleteHistoryBtns[index] ? 'delete-history-btn-active' : ''}}"
                variant="text"
                size="extra-small"
                shape="circle"
                bindtap="onDeleteHistory"
                bindtouchstart="onButtonTouchStart"
                bindtouchend="onButtonTouchEnd"
                data-button="deleteHistory"
                data-index="{{index}}"
              >
                <t-icon name="close" size="14" color="#ccc" />
              </t-button>
            </view>
          </t-cell>
        </t-cell-group>
      </view>
    </scroll-view>
    
    <!-- 空状态 -->
    <view class="empty-suggestions" wx:if="{{!isLoading && suggestions.length === 0 && searchHistory.length === 0 && inputValue}}">
      <t-empty 
        icon="search"
        description="暂无搜索建议"
      />
    </view>
  </view>
</view> 