<!-- ‰æßËæπÊäΩÂ±âÂÆπÂô® -->
<view class="drawer-container {{drawerTouching ? 'drawer-touching' : ''}}" style="left: {{drawerLeft}}rpx;">
  <!-- Â∑¶‰æßÈöêËóèÂå∫ÂüüÔºöÂçè‰ºöÊÄªËßà (800rpxÂÆΩ) -->
  <view class="drawer-sidebar"
    bindtouchstart="onDrawerTouchStart" 
    bindtouchmove="onDrawerTouchMove" 
    bindtouchend="onDrawerTouchEnd"
  >
    <club-overview-panel visible="{{drawerOpened}}" animationEnded="{{drawerAnimationEnded}}" />
  </view>

  <!-- Âè≥‰æß‰∏ªÂÜÖÂÆπÂå∫ÂüüÔºöÂéühomeÂÜÖÂÆπ -->
  <view class="drawer-main">
  <!-- È°∂ÈÉ®ÂØºËà™Ê†è -->
  <view class="header"
    bindtouchstart="onDrawerTouchStart" 
    bindtouchmove="onDrawerTouchMove" 
    bindtouchend="onDrawerTouchEnd"
  >
    <view class="user-info {{userInfoActive ? 'user-info-active' : ''}}" bindtap="navigateToUserInfo" bindtouchstart="handleUserInfoTouchStart" bindtouchend="handleUserInfoTouchEnd">
      <image class="avatar" src="{{userInfo.avatar}}"></image>
      <view class="user-detail">
        <text class="username">{{userInfo.username || 'ÁÇπÂáªÁôªÂΩï'}}</text>
      </view>
      <!-- ÊêúÁ¥¢Ê°ÜÂå∫Âüü -->
      <view class="search-section">
          <view class="search-input-container {{searchInputActive ? 'search-input-container-active' : ''}}" bindtap="navigateToSearch" bindtouchstart="handleSearchTouchStart" bindtouchend="handleSearchTouchEnd">
            <van-icon name="search" size="16px" color="#999" />
            <text class="search-placeholder">ÊêúÁ¥¢Áî®Êà∑„ÄÅÊ¥ªÂä®„ÄÅÂçè‰ºö...</text>
          </view>
        </view>
    </view>
    <view class="header-right">
      <expandable-container
        id="homeMessagesPanel"
        expanded-width="700"
        expanded-height="1280"
        bg-color="#e0e0e0"
        text-color="#333333"
        z-index="1500"
        bind:expand="onMessagesPanelExpand"
        bind:collapse="onMessagesPanelCollapse"
      >
        <view slot="trigger" class="notification-icon">
          <t-icon name="notification" size="24px" color="rgb(223, 118, 176)" />
          <view class="notification-badge" wx:if="{{unread_messages_count > 0}}">{{unread_messages_count > 99 ? '99+' : unread_messages_count}}</view>
        </view>
        <view slot="content" class="messages-panel">
          <view class="messages-panel-header">
            <view class="messages-panel-title">ÈÄöÁü•‰∏≠ÂøÉ</view>
            <view class="messages-panel-close" bindtap="onMessagesPanelClose">
              <van-icon name="cross" size="18px" color="#666666" />
            </view>
          </view>
          <view class="messages-panel-body">
            <view class="loading-container" wx:if="{{messagesLoading}}">
              <van-loading color="#1989fa" size="24px" />
              <text class="loading-text">Âä†ËΩΩ‰∏≠...</text>
            </view>
            <van-tabs wx:else active="{{messagesActiveTab}}" bind:change="onMessagesTabChange" swipeable animated>
              <van-tab title="Âçè‰ºöÈÄöÁü•">
                <scroll-view scroll-y="true" class="messages-tab-scroll">
                  <view class="messages-tab-content">
                    <view class="empty-container" wx:if="{{messagesEmptyClub}}">
                      <van-empty description="ÊöÇÊó†Âçè‰ºöÈÄöÁü•" />
                    </view>
                    <view class="notice-list" wx:else>
                      <view
                        class="notice-item {{!item.readDate ? 'unread' : ''}}"
                        wx:for="{{messagesClubNotices}}"
                        wx:key="message_id"
                        bindtap="onMessageItemTap"
                        data-message_id="{{item.message_id}}"
                        data-url="{{item.url}}"
                        data-type="club"
                      >
                        <view class="notice-icon">
                          <view class="icon-bg club-icon">
                            <van-icon name="cluster-o" color="#fff" size="20px" />
                          </view>
                          <view class="unread-dot" wx:if="{{!item.readDate}}"></view>
                        </view>
                        <view class="notice-content">
                          <view class="notice-title">{{item.title}}</view>
                          <view class="notice-desc">{{item.text}}</view>
                          <view class="notice-time">{{item.created_time}}</view>
                        </view>
                      </view>
                    </view>
                  </view>
                </scroll-view>
              </van-tab>
              <van-tab title="Ê¥ªÂä®ÈÄöÁü•">
                <scroll-view scroll-y="true" class="messages-tab-scroll">
                  <view class="messages-tab-content">
                    <view class="empty-container" wx:if="{{messagesEmptyEvent}}">
                      <van-empty description="ÊöÇÊó†Ê¥ªÂä®ÈÄöÁü•" />
                    </view>
                    <view class="notice-list" wx:else>
                      <view
                        class="notice-item {{!item.readDate ? 'unread' : ''}}"
                        wx:for="{{messagesEventNotices}}"
                        wx:key="message_id"
                        bindtap="onMessageItemTap"
                        data-message_id="{{item.message_id}}"
                        data-url="{{item.url}}"
                        data-type="event"
                      >
                        <view class="notice-icon">
                          <view class="icon-bg event-icon">
                            <van-icon name="calendar-o" color="#fff" size="20px" />
                          </view>
                          <view class="unread-dot" wx:if="{{!item.readDate}}"></view>
                        </view>
                        <view class="notice-content">
                          <view class="notice-title">{{item.title}}</view>
                          <view class="notice-desc">{{item.text}}</view>
                          <view class="notice-time">{{item.created_time}}</view>
                        </view>
                      </view>
                    </view>
                  </view>
                </scroll-view>
              </van-tab>
              <van-tab title="Á≥ªÁªüÈÄöÁü•">
                <scroll-view scroll-y="true" class="messages-tab-scroll">
                  <view class="messages-tab-content">
                    <view class="empty-container" wx:if="{{messagesEmptySystem}}">
                      <van-empty description="ÊöÇÊó†Á≥ªÁªüÈÄöÁü•" />
                    </view>
                    <view class="notice-list" wx:else>
                      <view
                        class="notice-item {{!item.readDate ? 'unread' : ''}}"
                        wx:for="{{messagesSystemNotices}}"
                        wx:key="message_id"
                        bindtap="onMessageItemTap"
                        data-message_id="{{item.message_id}}"
                        data-url="{{item.url}}"
                        data-type="system"
                      >
                        <view class="notice-icon">
                          <view class="icon-bg system-icon">
                            <van-icon name="info-o" color="#fff" size="20px" />
                          </view>
                          <view class="unread-dot" wx:if="{{!item.readDate}}"></view>
                        </view>
                        <view class="notice-content">
                          <view class="notice-title">{{item.title}}</view>
                          <view class="notice-desc">{{item.text}}</view>
                          <view class="notice-time">{{item.created_time}}</view>
                        </view>
                      </view>
                    </view>
                  </view>
                </scroll-view>
              </van-tab>
            </van-tabs>
          </view>
        </view>
      </expandable-container>
    </view>
  </view>

  <!-- Ëá™ÂÆö‰πâÊ†áÁ≠æÊ†è -->
  <view class="custom-tabs">
    <view class="custom-tab {{activeTab === 0 ? 'custom-tab-active' : ''}}" bindtap="switchTab" data-index="0">
      <text>Ê¥ªÂä®</text>
    </view>
    <view class="custom-tab {{activeTab === 1 ? 'custom-tab-active' : ''}}" bindtap="switchTab" data-index="1">
      <text>Âçè‰ºö</text>
    </view>
    <view class="custom-tab-line" style="left: {{activeTab * 50}}%"></view>
  </view>

  <!-- ÂÜÖÂÆπÂå∫Âüü - ‰ΩøÁî®swiperÂÆûÁé∞Â∑¶Âè≥ÊªëÂä® -->
  <swiper 
    class="tab-content-swiper" 
    current="{{activeTab}}" 
    bindchange="handleSwiperChange" 
    bindtransition="handleSwiperTransition" 
    bindanimationfinish="handleSwiperAnimationFinish"
    disable-touch="{{swiperDisableTouch}}"
  >
    <!-- Ê¥ªÂä®Ê†áÁ≠æÈ°µ -->
    <swiper-item>
      <scroll-view 
        scroll-y="{{!eventItemCatchMove && !swiperToDrawerMode}}"
        class="tab-content-scroll" 
        bindscrolltolower="onScrollToLower"
        bindscroll="onScrollViewScroll"
        bindtouchstart="onEventScrollTouchStart"
        bindtouchmove="onEventScrollTouchMove"
        bindtouchend="onEventScrollTouchEnd"
      >
        <!-- ÁÉ≠Èó®Ê¥ªÂä®ËΩÆÊí≠ -->
        <view class="hot-events-container" wx:if="{{hotActivities.length > 0}}">
          <swiper class="hot-events-swiper" indicator-dots="{{true}}" interval="{{3000}}" duration="{{500}}" circular="{{true}}">
            <swiper-item wx:for="{{hotActivities}}" wx:key="event_id" wx:for-index="hotIndex" list-item>
              <ripple
                ripple-color="rgba(223, 118, 176, 0.8)"
                duration="{{800}}"
                bindtap="openGlobalPopup"
                data-popup-type="{{item.cur_user_managed ? 'event-manage' : 'event-detail'}}"
                data-popup-id="{{item.event_id}}"
                data-bg-color="rgba(223, 118, 176, 0.8)"
                data-sheet-bg-color="#f7f8fa"
              >
                <view class="hot-event-card">
                <view class="hot-event-layout" style="height: 430rpx;">
                  <view class="hot-event-map-background" wx:if="{{item.location_data}}">
                    <view class="hot-event-map">
                      <image 
                        src="{{item.premap_url}}"
                        mode="aspectFill" />
                      <text class="location-name">{{item.location_data.name}}</text>
                      <view class="hot-event-overlay"></view>
                    </view>
                  </view>
                  <view class="hot-event-image-container">
                    <image class="hot-event-image" src="{{item.cover_url_thumb}}" mode="aspectFill" />
                    <view class="tag-managed" wx:if="{{item.cur_user_managed}}">ÊàëÁÆ°ÁêÜ</view>
                    <view class="tag-ended" wx:elif="{{item.end_time}}">Â∑≤ÁªìÊùü</view>
                    <view class="tag-joined" wx:elif="{{item.cur_user_is_joined}}">Â∑≤ÂèÇÂä†</view>
                  </view>
                  <view class="hot-event-participants">
                    <view class="participants-avatars">
                      <image wx:for="{{item.latest_joins}}" wx:for-item="member" wx:key="user_id" wx:if="{{index < 5}}" list-item src="{{member.avatar || default_avatar}}" class="participant-avatar" />
                      <view class="more-participants" wx:if="{{item.join_count > 5}}">...</view>
                    </view>
                    <text class="participants-count">{{item.join_count}}‰∫∫ÂèÇÂä†</text>
                  </view>
                  <view class="hot-event-info">
                    <view class="hot-event-title"><text>{{item.title}}</text></view>
                    <view class="hot-event-description"><text>{{item.description}}</text></view>
                    <view class="hot-event-time"><text>{{item.start_time}}</text></view>
                  </view>
                </view>
                </view>
              </ripple>
            </swiper-item>
          </swiper>
        </view>

        <!-- Ê¥ªÂä®ÁÄëÂ∏ÉÊµÅÈÉ®ÂàÜ - ‰ΩøÁî®ÂÖ®Â±ÄÂºπÁ™ó -->
        <view class="waterfall-container">
          <view class="waterfall-column">
            <block wx:for="{{eventList}}" wx:key="event_id" wx:for-index="index">
              <view wx:if="{{index % 2 === 0}}" class="card" style="width:100%;margin-bottom:15rpx;">
                <!-- Èò∂ÊÆµ1ÔºöÊï∞ÊçÆÊú™Âä†ËΩΩ - ÂÆåÊï¥È™®Êû∂Â±è -->
                <view wx:if="{{item.loading}}" class="card-skeleton">
                  <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx' }]}}" />
                  <view class="card-content">
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '80%', height: '28rpx', marginBottom: '12rpx' }]}}" />
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '50%', height: '22rpx' }]}}" />
                  </view>
                </view>
                
                <!-- Èò∂ÊÆµ2&3ÔºöÊï∞ÊçÆÂ∑≤Âä†ËΩΩ -->
                <ripple 
                  wx:else
                  ripple-color="rgba(223, 118, 176, 0.8)"
                  duration="{{800}}"
                  bindtap="openGlobalPopup"
                  data-popup-type="{{item.cur_user_managed ? 'event-manage' : 'event-detail'}}"
                  data-popup-id="{{item.event_id}}"
                  data-bg-color="rgba(223, 118, 176, 0.8)"
                  data-sheet-bg-color="#f7f8fa"
                >
                  <view class="card-wrapper">
                    <!-- ÂõæÁâáÂå∫Âüü -->
                    <view class="image-container" style="width:100%;height:280rpx;position:relative;">
                      <!-- Èò∂ÊÆµ2ÔºöÂõæÁâáÈ™®Êû∂Â±èÔºàË¶ÜÁõñÂú®ÂõæÁâá‰∏äÊñπÔºâ -->
                      <view wx:if="{{!item.imgLoaded}}" class="image-skeleton">
                        <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx 8rpx 0 0' }]}}" />
                      </view>
                      <!-- ÂõæÁâáÂßãÁªàÊ∏≤ÊüìÔºå‰ΩÜÂú®Êú™Âä†ËΩΩÂÆåÊàêÊó∂Ë¢´È™®Êû∂Â±èÈÅÆÊå° -->
                      <image class="card-image" src="{{item.cover_url_thumb}}" mode="aspectFill" bindload="onEventImgLoad" binderror="onEventImgLoad" data-index="{{index}}" style="{{item.imgLoaded ? '' : 'opacity: 0;'}}" />
                      <!-- Èò∂ÊÆµ3ÔºöÈÅÆÁΩ©ÂíåÊ†áÁ≠æÂè™Âú®ÂõæÁâáÂä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ -->
                      <block wx:if="{{item.imgLoaded}}">
                        <view class="image-gradient-mask"></view>
                        <view class="tag-managed" wx:if="{{item.cur_user_managed}}"><t-icon name="user-list" size="36rpx" color="#fff"></t-icon></view>
                        <view class="tag-ended" wx:elif="{{item.is_ended}}"><t-icon name="close-circle" size="36rpx" color="#fff"></t-icon></view>
                        <view class="tag-joined" wx:elif="{{item.cur_user_is_joined}}"><t-icon name="bookmark-checked" size="36rpx" color="#fff"></t-icon></view>
                      </block>
                    </view>
                    
                    <!-- ÊñáÂ≠óÂÜÖÂÆπÂå∫Âüü - Èò∂ÊÆµ2&3ÈÉΩÊòæÁ§∫ -->
                    <view class="card-content">
                      <view class="card-title"><text>{{item.title}}</text></view>
                      <view class="card-info-row">
                        <view class="card-club-name" wx:if="{{item.club_name}}"><text>{{item.club_name}}</text></view>
                        <view class="card-tag"><text>{{item.start_time}}</text></view>
                      </view>
                    </view>
                  </view>
                </ripple>
              </view>
            </block>
          </view>
          
          <view class="waterfall-column">
            <block wx:for="{{eventList}}" wx:key="event_id" wx:for-index="index">
              <view wx:if="{{index % 2 === 1}}" class="card" style="width:100%;margin-bottom:15rpx;">
                <!-- Èò∂ÊÆµ1ÔºöÊï∞ÊçÆÊú™Âä†ËΩΩ - ÂÆåÊï¥È™®Êû∂Â±è -->
                <view wx:if="{{item.loading}}" class="card-skeleton">
                  <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx' }]}}" />
                  <view class="card-content">
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '80%', height: '28rpx', marginBottom: '12rpx' }]}}" />
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '50%', height: '22rpx' }]}}" />
                  </view>
                </view>
                
                <!-- Èò∂ÊÆµ2&3ÔºöÊï∞ÊçÆÂ∑≤Âä†ËΩΩ -->
                <ripple 
                  wx:else
                  ripple-color="rgba(223, 118, 176, 0.8)"
                  duration="{{800}}"
                  bindtap="openGlobalPopup"
                  data-popup-type="{{item.cur_user_managed ? 'event-manage' : 'event-detail'}}"
                  data-popup-id="{{item.event_id}}"
                  data-bg-color="rgba(223, 118, 176, 0.8)"
                  data-sheet-bg-color="#f7f8fa"
                >
                  <view class="card-wrapper">
                    <!-- ÂõæÁâáÂå∫Âüü -->
                    <view class="image-container" style="width:100%;height:280rpx;position:relative;">
                      <!-- Èò∂ÊÆµ2ÔºöÂõæÁâáÈ™®Êû∂Â±èÔºàË¶ÜÁõñÂú®ÂõæÁâá‰∏äÊñπÔºâ -->
                      <view wx:if="{{!item.imgLoaded}}" class="image-skeleton">
                        <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx 8rpx 0 0' }]}}" />
                      </view>
                      <!-- ÂõæÁâáÂßãÁªàÊ∏≤ÊüìÔºå‰ΩÜÂú®Êú™Âä†ËΩΩÂÆåÊàêÊó∂Ë¢´È™®Êû∂Â±èÈÅÆÊå° -->
                      <image class="card-image" src="{{item.cover_url_thumb}}" mode="aspectFill" bindload="onEventImgLoad" binderror="onEventImgLoad" data-index="{{index}}" style="{{item.imgLoaded ? '' : 'opacity: 0;'}}" />
                      <!-- Èò∂ÊÆµ3ÔºöÈÅÆÁΩ©ÂíåÊ†áÁ≠æÂè™Âú®ÂõæÁâáÂä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ -->
                      <block wx:if="{{item.imgLoaded}}">
                        <view class="image-gradient-mask"></view>
                        <view class="tag-managed" wx:if="{{item.cur_user_managed}}"><t-icon name="user-list" size="36rpx" color="#fff"></t-icon></view>
                        <view class="tag-ended" wx:elif="{{item.is_ended}}"><t-icon name="close-circle" size="36rpx" color="#fff"></t-icon></view>
                        <view class="tag-joined" wx:elif="{{item.cur_user_is_joined}}"><t-icon name="bookmark-checked" size="36rpx" color="#fff"></t-icon></view>
                      </block>
                    </view>
                    
                    <!-- ÊñáÂ≠óÂÜÖÂÆπÂå∫Âüü - Èò∂ÊÆµ2&3ÈÉΩÊòæÁ§∫ -->
                    <view class="card-content">
                      <view class="card-title"><text>{{item.title}}</text></view>
                      <view class="card-info-row">
                        <view class="card-club-name" wx:if="{{item.club_name}}"><text>{{item.club_name}}</text></view>
                        <view class="card-tag"><text>{{item.start_time}}</text></view>
                      </view>
                    </view>
                  </view>
                </ripple>
              </view>
            </block>
          </view>
        </view>
      </scroll-view>
    </swiper-item>

    <!-- Âçè‰ºöÊ†áÁ≠æÈ°µ -->
    <swiper-item>
      <scroll-view 
        scroll-y="true" 
        class="tab-content-scroll" 
        bindscrolltolower="onScrollToLower"
        bindscroll="onScrollViewScroll"
        bindtouchstart="onScrollTouchStart"
        bindtouchmove="onScrollTouchMove"
        bindtouchend="onScrollTouchEnd"
      >
        <!-- ÁÉ≠Èó®Âçè‰ºöËΩÆÊí≠ - Êµ∑Êä•ÂºèËÆæËÆ° -->
        <view class="hot-clubs-container" wx:if="{{hotClubs.length > 0}}">
          <swiper class="hot-clubs-swiper" indicator-dots="{{true}}" interval="{{4000}}" duration="{{600}}" circular="{{true}}" bindchange="onClubSwiperChange">
            <swiper-item wx:for="{{hotClubs}}" wx:key="club_id" wx:for-index="hotIndex" list-item>
              <ripple
                ripple-color="rgba(223, 118, 176, 0.8)"
                duration="{{800}}"
                bindtap="openGlobalPopup"
                data-popup-type="{{item.cur_user_managed ? 'club-manage' : 'club-detail'}}"
                data-popup-id="{{item.club_id}}"
                data-bg-color="rgba(223, 118, 176, 0.8)"
                data-sheet-bg-color="{{item.cur_user_managed ? '#f5f5f5' : '#fff'}}"
              >
                <view class="hot-club-poster-card">
                <view class="hot-club-trigger">
                  <!-- isotopeËÉåÊôØ -->
                  <view class="isotope-background-container">
                    <isotope
                      id="hotClubIsotope-{{index}}"
                      items="{{item.isotopeData}}"
                      layoutMode="masonryHorizontal"
                      masonryHorizontal="{{masonryHorizontalConfig}}"
                      width="750rpx"
                      height="450rpx"
                      gutter="{{10}}"
                      transitionDuration="0.8s"
                      groupInterval="5000"
                      backgroundColor="rgb(108, 99, 104)">
                    </isotope>
                    <view class="isotope-overlay"></view>
                  </view>
                  <!-- ‰ºöÈïøÂ§¥ÂÉèÂ±ïÁ§∫Âå∫ -->
                  <view class="poster-president-section" wx:if="{{item.posterData.president}}">
                    <view class="president-avatar-container">
                      <image class="president-avatar" src="{{item.posterData.president.avatar}}" mode="aspectFill" />
                      <view class="president-glow"></view>
                    </view>
                    <view class="president-badge"><text class="badge-text">‰ºöÈïø</text></view>
                    <view class="president-name"><text class="president-name-text">{{item.posterData.president.name}}</text></view>
                  </view>
                  <!-- Âçè‰ºöÊèèËø∞Âå∫Âüü -->
                  <view class="poster-description-section">
                    <view class="description-content"><text class="description-text">{{item.description}}</text></view>
                  </view>
                  <!-- Âçè‰ºö‰ø°ÊÅØÂ±ïÁ§∫Âå∫ -->
                  <view class="poster-info-section">
                    <view class="club-title">
                      <text class="main-title">{{item.club_name}}</text>
                      <view class="title-underline"></view>
                    </view>
                    <view class="club-stats">
                      <view class="stat-item"><text class="stat-number">{{item.posterData.memberCount}}</text><text class="stat-label">ÊàêÂëò</text></view>
                      <view class="stat-item"><text class="stat-number">{{item.posterData.eventCount}}</text><text class="stat-label">Ê¥ªÂä®</text></view>
                    </view>
                  </view>
                  <!-- Ê†áËØÜ -->
                  <view class="poster-badge">
                    <view class="badge-icon">{{item.cur_user_managed ? '‚öôÔ∏è' : 'üèÜ'}}</view>
                    <view class="badge-text">{{item.cur_user_managed ? 'ÊàëÁÆ°ÁêÜ' : 'ÁÉ≠Èó®Âçè‰ºö'}}</view>
                  </view>
                </view>
                </view>
              </ripple>
            </swiper-item>
          </swiper>
        </view>

        <!-- Âçè‰ºöÁÄëÂ∏ÉÊµÅÈÉ®ÂàÜ - ‰ΩøÁî®ÂÖ®Â±ÄÂºπÁ™ó -->
        <view class="waterfall-container">
          <view class="waterfall-column">
            <block wx:for="{{clubList}}" wx:key="club_id" wx:for-index="index">
              <view wx:if="{{index % 2 === 0}}" class="card" style="width:100%;margin-bottom:15rpx;">
                <!-- Èò∂ÊÆµ1ÔºöÊï∞ÊçÆÊú™Âä†ËΩΩ - ÂÆåÊï¥È™®Êû∂Â±è -->
                <view wx:if="{{item.loading}}" class="card-skeleton">
                  <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx' }]}}" />
                  <view class="card-content">
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '80%', height: '28rpx', marginBottom: '12rpx' }]}}" />
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '60%', height: '22rpx' }]}}" />
                  </view>
                </view>
                
                <!-- Èò∂ÊÆµ2&3ÔºöÊï∞ÊçÆÂ∑≤Âä†ËΩΩ -->
                <ripple 
                  wx:else
                  ripple-color="rgba(223, 118, 176, 0.8)"
                  duration="{{800}}"
                  bindtap="openGlobalPopup"
                  data-popup-type="{{item.cur_user_managed ? 'club-manage' : 'club-detail'}}"
                  data-popup-id="{{item.club_id}}"
                  data-bg-color="rgba(223, 118, 176, 0.8)"
                  data-sheet-bg-color="{{item.cur_user_managed ? '#f5f5f5' : '#fff'}}"
                >
                  <view class="card-wrapper">
                  <!-- ÂõæÁâáÂå∫Âüü -->
                  <view class="image-container" style="width:100%;height:280rpx;position:relative;">
                    <!-- Èò∂ÊÆµ2ÔºöÂõæÁâáÈ™®Êû∂Â±èÔºàË¶ÜÁõñÂú®ÂõæÁâá‰∏äÊñπÔºâ -->
                    <view wx:if="{{!item.imgLoaded}}" class="image-skeleton">
                      <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx 8rpx 0 0' }]}}" />
                    </view>
                    <!-- ÂõæÁâáÂßãÁªàÊ∏≤ÊüìÔºå‰ΩÜÂú®Êú™Âä†ËΩΩÂÆåÊàêÊó∂Ë¢´È™®Êû∂Â±èÈÅÆÊå° -->
                    <image class="card-image" src="{{item.cover_url_thumb}}" mode="aspectFill" bindload="onClubImgLoad" binderror="onClubImgLoad" data-index="{{index}}" style="{{item.imgLoaded ? '' : 'opacity: 0;'}}" />
                    <!-- Èò∂ÊÆµ3ÔºöÈÅÆÁΩ©ÂíåÊ†áÁ≠æÂè™Âú®ÂõæÁâáÂä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ -->
                    <block wx:if="{{item.imgLoaded}}">
                      <view class="image-gradient-mask"></view>
                      <view class="tag-managed" wx:if="{{item.cur_user_managed}}"><t-icon name="user-list" size="36rpx" color="#fff"></t-icon></view>
                      <view class="tag-joined" wx:elif="{{item.cur_user_is_member}}"><t-icon name="bookmark-checked" size="36rpx" color="#fff"></t-icon></view>
                    </block>
                  </view>
                  
                  <!-- ÊñáÂ≠óÂÜÖÂÆπÂå∫Âüü - Èò∂ÊÆµ2&3ÈÉΩÊòæÁ§∫ -->
                  <view class="card-content">
                    <view class="card-title"><text>{{item.club_name}}</text></view>
                    <view class="card-desc"><text>{{item.description}}</text></view>
                  </view>
                  </view>
                </ripple>
              </view>
            </block>
          </view>
          
          <view class="waterfall-column">
            <block wx:for="{{clubList}}" wx:key="club_id" wx:for-index="index">
              <view wx:if="{{index % 2 === 1}}" class="card" style="width:100%;margin-bottom:15rpx;">
                <!-- Èò∂ÊÆµ1ÔºöÊï∞ÊçÆÊú™Âä†ËΩΩ - ÂÆåÊï¥È™®Êû∂Â±è -->
                <view wx:if="{{item.loading}}" class="card-skeleton">
                  <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx' }]}}" />
                  <view class="card-content">
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '80%', height: '28rpx', marginBottom: '12rpx' }]}}" />
                    <t-skeleton animation="gradient" rowCol="{{[{ width: '60%', height: '22rpx' }]}}" />
                  </view>
                </view>
                
                <!-- Èò∂ÊÆµ2&3ÔºöÊï∞ÊçÆÂ∑≤Âä†ËΩΩ -->
                <ripple 
                  wx:else
                  ripple-color="rgba(223, 118, 176, 0.8)"
                  duration="{{800}}"
                  bindtap="openGlobalPopup"
                  data-popup-type="{{item.cur_user_managed ? 'club-manage' : 'club-detail'}}"
                  data-popup-id="{{item.club_id}}"
                  data-bg-color="rgba(223, 118, 176, 0.8)"
                  data-sheet-bg-color="{{item.cur_user_managed ? '#f5f5f5' : '#fff'}}"
                >
                  <view class="card-wrapper">
                  <!-- ÂõæÁâáÂå∫Âüü -->
                  <view class="image-container" style="width:100%;height:280rpx;position:relative;">
                    <!-- Èò∂ÊÆµ2ÔºöÂõæÁâáÈ™®Êû∂Â±èÔºàË¶ÜÁõñÂú®ÂõæÁâá‰∏äÊñπÔºâ -->
                    <view wx:if="{{!item.imgLoaded}}" class="image-skeleton">
                      <t-skeleton animation="gradient" rowCol="{{[{ width: '100%', height: '280rpx', borderRadius: '8rpx 8rpx 0 0' }]}}" />
                    </view>
                    <!-- ÂõæÁâáÂßãÁªàÊ∏≤ÊüìÔºå‰ΩÜÂú®Êú™Âä†ËΩΩÂÆåÊàêÊó∂Ë¢´È™®Êû∂Â±èÈÅÆÊå° -->
                    <image class="card-image" src="{{item.cover_url_thumb}}" mode="aspectFill" bindload="onClubImgLoad" binderror="onClubImgLoad" data-index="{{index}}" style="{{item.imgLoaded ? '' : 'opacity: 0;'}}" />
                    <!-- Èò∂ÊÆµ3ÔºöÈÅÆÁΩ©ÂíåÊ†áÁ≠æÂè™Âú®ÂõæÁâáÂä†ËΩΩÂÆåÊàêÂêéÊòæÁ§∫ -->
                    <block wx:if="{{item.imgLoaded}}">
                      <view class="image-gradient-mask"></view>
                      <view class="tag-managed" wx:if="{{item.cur_user_managed}}"><t-icon name="user-list" size="36rpx" color="#fff"></t-icon></view>
                      <view class="tag-joined" wx:elif="{{item.cur_user_is_member}}"><t-icon name="bookmark-checked" size="36rpx" color="#fff"></t-icon></view>
                    </block>
                  </view>
                  
                  <!-- ÊñáÂ≠óÂÜÖÂÆπÂå∫Âüü - Èò∂ÊÆµ2&3ÈÉΩÊòæÁ§∫ -->
                  <view class="card-content">
                    <view class="card-title"><text>{{item.club_name}}</text></view>
                    <view class="card-desc"><text>{{item.description}}</text></view>
                  </view>
                  </view>
                </ripple>
              </view>
            </block>
          </view>
        </view>
      </scroll-view>
    </swiper-item>
  </swiper>

  <!-- ÂÖ®Â±ÄÂÖ®Â±èÂºπÁ™ó - ÊîæÂú® swiper Â§ñÈÉ®ÔºåÈÅøÂÖçË¢´ swiper ÈôêÂà∂ -->
  <expandable-container_fullscreen 
    wx:if="{{globalPopup.visible}}"
    id="globalFullscreenPopup"
    bg-color="{{globalPopup.bgColor}}"
    fullscreen-sheet-bg-color="{{globalPopup.sheetBgColor}}"
    fullscreen-top-padding="{{0}}"
    bind:collapse="onGlobalPopupCollapse"
    bind:contentReady="onGlobalPopupContentReady"
  >
    <view slot="trigger"></view>
    <view slot="content" class="popup-content-wrapper">
      <!-- È™®Êû∂Â±è - Ë¶ÜÁõñÂú® panel ‰∏äÈù¢ -->
      <view wx:if="{{globalPopup.loading}}" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 999; background: #f7f8fa;">
        <event-manage-skeleton wx:if="{{globalPopup.type === 'event-manage'}}" />
        <event-detail-skeleton wx:if="{{globalPopup.type === 'event-detail'}}" />
        <club-detail-skeleton wx:if="{{globalPopup.type === 'club-detail'}}" />
        <club-manage-skeleton wx:if="{{globalPopup.type === 'club-manage'}}" />
      </view>

      <!-- ÁúüÂÆû panel ÁªÑ‰ª∂ - Âª∂ËøüÊ∏≤Êüì -->
      <block wx:if="{{globalPopup.renderPanel}}">
        <!-- Ê¥ªÂä®ËØ¶ÊÉÖ -->
        <event-detail-panel 
          wx:if="{{globalPopup.type === 'event-detail'}}"
          id="globalEventDetailPanel" 
          event-id="{{globalPopup.id}}" 
          bind:update="onEventDetailPanelUpdate" 
          bind:navigateClub="onNavigateClubFromPanel"
          bind:loaded="onGlobalPopupLoaded"
          bind:close="closeGlobalPopup"
        />
        <!-- Ê¥ªÂä®ÁÆ°ÁêÜ -->
        <event-manage-panel 
          wx:if="{{globalPopup.type === 'event-manage'}}"
          id="globalEventManagePanel" 
          event-id="{{globalPopup.id}}" 
          bind:update="onEventManagePanelUpdate"
          bind:loaded="onGlobalPopupLoaded"
          bind:close="closeGlobalPopup"
        />
        <!-- Âçè‰ºöËØ¶ÊÉÖ -->
        <club-detail-panel 
          wx:if="{{globalPopup.type === 'club-detail'}}"
          id="globalClubDetailPanel" 
          club-id="{{globalPopup.id}}" 
          bind:update="onClubDetailPanelUpdate" 
          bind:navigateEvent="onNavigateEventFromPanel"
          bind:loaded="onGlobalPopupLoaded"
          bind:close="closeGlobalPopup"
        />
        <!-- Âçè‰ºöÁÆ°ÁêÜ -->
        <club-manage-panel 
          wx:if="{{globalPopup.type === 'club-manage'}}"
          id="globalClubManagePanel" 
          club-id="{{globalPopup.id}}" 
          bind:update="onClubManagePanelUpdate" 
          bind:navigateEvent="onNavigateEventFromPanel" 
          bind:dissolved="onClubDissolved"
          bind:loaded="onGlobalPopupLoaded"
          bind:close="closeGlobalPopup"
        />
      </block>
    </view>
  </expandable-container_fullscreen>
  </view>
</view>