# 预计时间编辑功能说明

## 功能概述
在活动管理页面（`packageEvent/event-manage`）新增了预计开始时间和预计结束时间的编辑功能，参考了`eventcreate`页面的实现。

## 新增功能

### 1. 界面显示
- 在信息网格中新增两个块：
  - **预计开始时间**：显示`featuredEvent.pre_start_time_display`（来源于`featuredEvent.pre_startTime`），可点击编辑
  - **预计结束时间**：显示`featuredEvent.pre_end_time_display`（来源于`featuredEvent.pre_endTime`），只读显示

### 2. 编辑功能
- 点击"预计开始时间"块打开编辑弹窗
- 弹窗默认显示当前已有的预计时间数据（来自`formData.preStartTimeDisplay`）
- 弹窗包含：
  - 预计开始时间选择器（日期+时间）
  - 活动时长滑块（1-8小时）
  - 预计结束时间显示（自动计算）

### 3. 数据处理逻辑
- **页面显示**：直接从`featuredEvent.pre_start_time_display`和`pre_end_time_display`获取
- **弹窗编辑**：使用`formData`作为临时编辑数据，包含`preStartTimeDisplay`等字段
- **数据初始化**：`loadEvent`时将现有预计时间（`pre_startTime`和`pre_endTime`）格式化并设置到`formData`作为默认值
- **数据更新**：只有点击确认并成功提交后，才重新加载页面数据更新显示
- **变量统一**：统一使用`pre_startTime`和`pre_endTime`作为后端字段名
- 自动格式化时间显示
- 实时计算预计结束时间
- 提交到后端API `/event/{eventId}/update_pre_schedule`

## 技术实现

### 数据流：
1. `loadEvent` → 获取`pre_startTime`和`pre_endTime` → 格式化为`pre_start_time_display`和`pre_end_time_display`字段
2. `initializeFormData` → 将现有时间设置到`formData.preStartTimeDisplay`等字段作为弹窗默认值
3. 用户编辑 → 修改`formData` → 提交到后端
4. 成功后 → 重新`loadEvent` → 更新页面显示

### 变量命名统一：
- 后端字段：`pre_startTime`、`pre_endTime`
- 显示字段：`pre_start_time_display`、`pre_end_time_display`
- 表单字段：`formData.preStartTimeDisplay`、`formData.preEndTimeDisplay`

### 新增文件修改：
1. **WXML文件**：
   - 在信息网格中添加预计开始时间和结束时间块
   - 显示数据来源：`featuredEvent.pre_start_time_display`和`pre_end_time_display`
   - 添加时间编辑弹窗，弹窗内显示`formData.preStartTimeDisplay`
   - 添加日期时间选择器

2. **JS文件**：
   - 新增`formData`数据结构管理弹窗编辑数据
   - 在`loadEvent`中格式化时间显示字段（`pre_start_time_display`等）
   - 添加`editStartTime`、`confirmTime`等相关方法
   - `initializeFormData`将现有时间设置为弹窗默认值
   - 统一使用`pre_startTime`和`pre_endTime`变量名

## 使用方法

1. 进入活动管理页面
2. 查看当前的预计开始和结束时间
3. 点击"预计开始时间"进入编辑模式
4. 弹窗默认显示当前已有的时间
5. 调整日期时间和活动时长
6. 确认保存，成功后页面自动更新显示最新时间

## 注意事项
- 页面显示的时间来自后端数据（`pre_startTime`/`pre_endTime`），确保数据准确性
- 弹窗编辑使用独立的数据结构（`formData`），避免误操作影响显示
- 只有确认提交成功后才更新页面显示
- 该功能不影响现有的其他功能
- 保持与`eventcreate`页面的一致性
- 变量命名已统一为`pre_startTime`和`pre_endTime` 